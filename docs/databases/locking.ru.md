# locking

1. Блокировка таблицы в PostgreSQL предотвращает другие транзакции от выполнения операций записи или чтения на этой таблице. Блокировка строки в PostgreSQL предотвращает другие транзакции от изменения или чтения определенной строки в таблице.

2. В PostgreSQL поддерживаются различные виды блокировок, такие как SHARE, ROW SHARE, ROW EXCLUSIVE, SHARE UPDATE EXCLUSIVE, EXCLUSIVE и другие.

3. Основное различие между блокировкой таблицы и блокировкой строки заключается в том, что блокировка таблицы предотвращает доступ ко всем данным в таблице, в то время как блокировка строки применяется только к конкретной строке данных.

4. Для определения активных блокировок в PostgreSQL можно использовать системную функцию pg_locks или команду pg_stat_activity.

5. Операции, которые могут вызвать блокировку всей таблицы в PostgreSQL, включают операции ALTER TABLE, TRUNCATE TABLE, VACUUM FULL и другие операции, которые требуют эксклюзивного доступа к таблице.

6. SHARE блокировка позволяет другим транзакциям читать данные, но не позволяет им изменять данные. EXCLUSIVE блокировка предотвращает другие транзакции от чтения или изменения данных.

7. Для избежания блокировки таблицы при одновременном выполнении операций чтения и записи можно использовать уровни изоляции транзакций, оптимизировать запросы, использовать индексы и разграничивать доступ к данным.

8. В PostgreSQL можно установить блокировку на отдельные строки с помощью команды SELECT ... FOR UPDATE или использовать специальные типы блокировок для строк.

9. Deadlock - это ситуация, когда две или более транзакции блокируют друг друга, ожидая освобождения ресурсов, которые удерживают другие транзакции. Для предотвращения deadlock'ов в PostgreSQL можно использовать правильное управление транзакциями, избегать длинных транзакций и использовать стратегии обработки deadlock'ов.

10. Для минимизации конфликтов блокировок при высокой нагрузке на базу данных можно использовать разделение данных, оптимизацию запросов, использование индексов, правильное управление транзакциями и мониторинг активных блокировок.

11. Рекомендации по использованию блокировок включают выбор наиболее подходящего уровня изоляции транзакций, оптимизацию запросов, избегание длинных транзакций, использование индексов и правильное управление конфликтами блокировок.

12. В PostgreSQL можно установить блокировку на несколько таблиц одновременно с помощью команды LOCK TABLE.

13. Проблемы, которые могут возникнуть при длительной блокировке таблицы в PostgreSQL, включают задержки в доступе к данным для других пользователей, возможные deadlock'ы и ухудшение производительности системы.

14. Отличие между NOWAIT и WAIT блокировками в PostgreSQL заключается в том, что NOWAIT пытается получить блокировку без ожидания, а WAIT будет ждать до момента получения блокировки.

15. Для проверки активных блокировок для конкретной таблицы в PostgreSQL можно использовать запрос к системным каталогам pg_locks и pg_stat_activity с фильтрацией по имени таблицы.
